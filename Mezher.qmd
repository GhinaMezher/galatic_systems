---
title: "Mezher"
author: "Ghina Mezher"
format: html
---

Github repository: https://github.com/GhinaMezher/galatic_systems.git

#Dowloading the needed libraries for our lab
```{r}
#| message: false
here::i_am("galatic_systems.Rproj")
library(here)
library(dplyr)
library(ggplot2)
library(tidyr)
library(vroom)
library(knitr)
```

# Question 3
```{r}
allsystems<-vroom(here("data","allsystems.csv"),delim=":")
allsystems|>summarise("Data set name"="allsystems.csv" ,
                      "Number of star systems"=n(),
                      "Number of variables"=ncol(allsystems),
                      "Are all numerical?"=all(sapply(allsystems,is.numeric)))|>
  knitr::kable()
```

# Question 4
```{r}
allsystems_pivot<-sapply(allsystems,as.character)
allsystems_pivot<-pivot_longer(allsystems_pivot,cols=-c(star_idx,Star_name),names_to="Variable",values_to="Values")
allsystems|>
  summarise("nb of observations"=n(),
  "number of variables"=ncol(allsystems),
  "missing values"=colSums(is.na(allsystems_pivot)),
  "missing observations"=rowSums(is.na(allsystems_pivot)))
```
## Question 5
```{r warning=FALSE}
allsystems|>
  ggplot(aes(x=`star temperature`,y=`Relative Luminosity`))+
  geom_line()+
  geom_rug(alpha=0.1, linewidth=1)+
  labs(x = "Star Temperature", y = "Star Luminosity", title = "Star luminosity according to its temperature")
```
# Question 6
```{r}
extreme_values<-function(df,var1,var2){
  max<-df|>select(var1,var2)|>
    slice_max(order_by={{var2}})
  min<-df|>select(var1,var2)|>slice_min(order_by={{var2}})
  bind_rows(max,min)
}

allsystems|>extreme_values(Star_name,`star temperature`)
```

# Question 8
```{r message=FALSE}
BT_FACTIONS<-vroom(here("data","BT%FACTIONS.csv"))
Bt_faction_system<-vroom(here("data","Bt_faction_system.csv"),delim=":")
```
# Question 9
```{r}
Bt_faction_system|>
  filter(FKEY %in% c("A","I","U"))|>
  group_by(FKEY)|>
  summarise(count=n())
```
# Question 10
```{r}
tot_systems<-unique(BT_FACTIONS$FKEY)
included_systems<-unique(Bt_faction_system$FKEY)

not_included_systems<-tot_systems[!(tot_systems%in%included_systems)]

print(length(not_included_systems))

```
#Question 11
```{r}
merged_systems<-merge(Bt_faction_system,BT_FACTIONS,by="FKEY")
merged_systems|>group_by(`Name Of The Faction`)|>
  summarise(count=n())|>
  filter(count>0)|>
  ggplot(aes(x=`Name Of The Faction`,y=count))+
  geom_bar(stat="identity",fill="skyblue")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  labs()
```

#Question 12



